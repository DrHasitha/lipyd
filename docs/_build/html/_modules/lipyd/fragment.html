

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>lipyd.fragment &mdash; lipyd 0.7.19 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> lipyd
          

          
          </a>

          
            
            
              <div class="version">
                0.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../source/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../source/modules.html">Reference manual</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">lipyd</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>lipyd.fragment</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for lipyd.fragment</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="c1">#</span>
<span class="c1">#  This file is part of the `lipyd` python module</span>
<span class="c1">#</span>
<span class="c1">#  Copyright (c) 2015-2018 - EMBL</span>
<span class="c1">#</span>
<span class="c1">#  File author(s): Dénes Türei (turei.denes@gmail.com)</span>
<span class="c1">#</span>
<span class="c1">#  Distributed under the GNU GPLv3 License.</span>
<span class="c1">#  See accompanying file LICENSE.txt or copy at</span>
<span class="c1">#      http://www.gnu.org/licenses/gpl-3.0.html</span>
<span class="c1">#</span>
<span class="c1">#  Website: http://www.ebi.ac.uk/~denes</span>
<span class="c1">#</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Classes representing fragment ions in MS2 spectra.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">print_function</span>
<span class="kn">from</span> <span class="nn">future.utils</span> <span class="k">import</span> <span class="n">iteritems</span>
<span class="kn">from</span> <span class="nn">past.builtins</span> <span class="k">import</span> <span class="n">xrange</span><span class="p">,</span> <span class="nb">range</span><span class="p">,</span> <span class="n">reduce</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">imp</span>
<span class="kn">import</span> <span class="nn">collections</span>

<span class="kn">import</span> <span class="nn">lipyd.mass</span> <span class="k">as</span> <span class="nn">mass</span>
<span class="kn">import</span> <span class="nn">lipyd.lipproc</span> <span class="k">as</span> <span class="nn">lipproc</span>
<span class="kn">import</span> <span class="nn">lipyd.metabolite</span> <span class="k">as</span> <span class="nn">metabolite</span>


<span class="n">fattyfragments</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([])</span>


<span class="n">ChainFragParam</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s1">&#39;ChainFragParam&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;plus&#39;</span><span class="p">,</span> <span class="s1">&#39;minus&#39;</span><span class="p">,</span> <span class="s1">&#39;charge&#39;</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;chaintype&#39;</span><span class="p">,</span> <span class="s1">&#39;constraints&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ChainFragParam</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">((),)</span>


<span class="n">FragConstraint</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">namedtuple</span><span class="p">(</span>
    <span class="s1">&#39;FragConstraint&#39;</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;hg&#39;</span><span class="p">,</span> <span class="s1">&#39;family&#39;</span><span class="p">,</span> <span class="s1">&#39;sub&#39;</span><span class="p">,</span> <span class="s1">&#39;sph&#39;</span><span class="p">,</span> <span class="s1">&#39;oh&#39;</span><span class="p">,</span> <span class="s1">&#39;chaintype&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">FragConstraint</span><span class="o">.</span><span class="fm">__new__</span><span class="o">.</span><span class="vm">__defaults__</span> <span class="o">=</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>


<div class="viewcode-block" id="AdductCalculator"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator">[docs]</a><span class="k">class</span> <span class="nc">AdductCalculator</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Deprecated. To be removed soon.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reform</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([A-Za-z][a-z]*)([0-9]*)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_counts</span><span class="p">()</span>
    
<div class="viewcode-block" id="AdductCalculator.init_counts"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator.init_counts">[docs]</a>    <span class="k">def</span> <span class="nf">init_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;counts&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="p">{}</span></div>
    
<div class="viewcode-block" id="AdductCalculator.formula2counts"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator.formula2counts">[docs]</a>    <span class="k">def</span> <span class="nf">formula2counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">reform</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
            <span class="k">yield</span> <span class="n">elem</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">num</span> <span class="ow">or</span> <span class="s1">&#39;1&#39;</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="AdductCalculator.remove"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator.remove">[docs]</a>    <span class="k">def</span> <span class="nf">remove</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula2counts</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="o">-</span><span class="n">num</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="AdductCalculator.add"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">formula</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">num</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">formula2counts</span><span class="p">(</span><span class="n">formula</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="n">num</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="AdductCalculator.add_atoms"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.AdductCalculator.add_atoms">[docs]</a>    <span class="k">def</span> <span class="nf">add_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">elem</span><span class="p">,</span> <span class="n">num</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">elem</span><span class="p">]</span> <span class="o">=</span> <span class="n">num</span> <span class="k">if</span> <span class="n">elem</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span> \
            <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">[</span><span class="n">elem</span><span class="p">]</span> <span class="o">+</span> <span class="n">num</span></div></div>


<div class="viewcode-block" id="FattyFragment"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragment">[docs]</a><span class="k">class</span> <span class="nc">FattyFragment</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">AbstractSubstituent</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Represents a fragment ion derived from a moiety with variable length</span>
<span class="sd">    aliphatic chain.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">head</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
            <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;UnknownFattyFragment</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="n">ionmode</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">):</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">ionmode</span> <span class="o">=</span> <span class="n">ionmode</span>
        
        <span class="k">def</span> <span class="nf">getname</span><span class="p">(</span><span class="n">parent</span><span class="p">):</span>
            
            <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">%</span> <span class="p">(</span>
                    <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="n">lipproc</span><span class="o">.</span><span class="n">cu_str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="n">parent</span><span class="o">.</span><span class="n">u</span><span class="p">)</span>
                    <span class="p">)</span>
                <span class="p">),</span>
                <span class="n">lipproc</span><span class="o">.</span><span class="n">charge_str</span><span class="p">(</span><span class="n">parent</span><span class="o">.</span><span class="n">charge</span><span class="p">)</span>
            <span class="p">)</span>
        
        <span class="n">cminus</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
            <span class="p">(</span><span class="n">elem</span><span class="p">,</span> <span class="o">-</span><span class="n">cnt</span><span class="p">)</span> <span class="k">for</span> <span class="n">elem</span><span class="p">,</span> <span class="n">cnt</span> <span class="ow">in</span>
            <span class="n">iteritems</span><span class="p">(</span><span class="n">metabolite</span><span class="o">.</span><span class="n">formula</span><span class="o">.</span><span class="n">formula2atoms</span><span class="p">(</span><span class="n">minus</span><span class="p">))</span>
        <span class="p">)</span>
        
        <span class="n">cminus</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cminus</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">2</span> <span class="k">if</span> <span class="s1">&#39;H&#39;</span> <span class="ow">in</span> <span class="n">cminus</span> <span class="k">else</span> <span class="o">-</span><span class="mi">2</span>
        
        <span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span> <span class="ow">or</span> <span class="p">{}</span>
        <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;fragtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;fragtype&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;fragtype&#39;</span> <span class="ow">in</span> <span class="n">attrs</span> <span class="k">else</span>
            <span class="k">lambda</span> <span class="n">parent</span><span class="p">:</span> <span class="p">(</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="o">%</span> <span class="s1">&#39;&#39;</span>
                <span class="k">if</span> <span class="s1">&#39;</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">name</span> <span class="k">else</span>
                <span class="n">parent</span><span class="o">.</span><span class="n">name</span>
            <span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">metabolite</span><span class="o">.</span><span class="n">AbstractSubstituent</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="n">cores</span> <span class="o">=</span> <span class="p">[</span><span class="n">head</span><span class="p">],</span>
            <span class="n">counts</span> <span class="o">=</span> <span class="n">cminus</span><span class="p">,</span>
            <span class="n">names</span> <span class="o">=</span> <span class="n">name</span><span class="p">,</span>
            <span class="n">charges</span> <span class="o">=</span> <span class="n">charge</span><span class="p">,</span>
            <span class="n">getname</span> <span class="o">=</span> <span class="n">getname</span><span class="p">,</span>
            <span class="c1"># we keep this 0 to avoid complicating further</span>
            <span class="n">valence</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
            <span class="n">attrs</span> <span class="o">=</span> <span class="n">attrs</span><span class="p">,</span>
            <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    
<div class="viewcode-block" id="FattyFragment.cu_str"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragment.cu_str">[docs]</a>    <span class="k">def</span> <span class="nf">cu_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lipproc</span><span class="o">.</span><span class="n">cu_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">))</span></div>
    
<div class="viewcode-block" id="FattyFragment.charge_str"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragment.charge_str">[docs]</a>    <span class="k">def</span> <span class="nf">charge_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="n">lipproc</span><span class="o">.</span><span class="n">charge_str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)</span></div>
    
<div class="viewcode-block" id="FattyFragment.get_name"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragment.get_name">[docs]</a>    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">]</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">cu_str</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_str</span><span class="p">())</span></div>
    
<div class="viewcode-block" id="FattyFragment.iterfraglines"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragment.iterfraglines">[docs]</a>    <span class="k">def</span> <span class="nf">iterfraglines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            
            <span class="k">yield</span> <span class="p">[</span>
                <span class="n">fr</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span>
                <span class="n">fr</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">fragtype</span><span class="p">,</span>
                <span class="n">fr</span><span class="o">.</span><span class="n">attrs</span><span class="o">.</span><span class="n">chaintype</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">u</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
            <span class="p">]</span></div></div>

<div class="viewcode-block" id="FattyFragmentOld"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentOld">[docs]</a><span class="k">class</span> <span class="nc">FattyFragmentOld</span><span class="p">(</span><span class="n">mass</span><span class="o">.</span><span class="n">MassBase</span><span class="p">,</span> <span class="n">AdductCalculator</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">unsat</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">minus</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">plus</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">isotope</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">hg</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="n">c</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">unsat</span> <span class="o">=</span> <span class="n">unsat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minus</span> <span class="o">=</span> <span class="n">minus</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plus</span>  <span class="o">=</span> <span class="n">plus</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hg</span> <span class="o">=</span> <span class="n">hg</span> <span class="ow">or</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">init_counts</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_atoms</span><span class="p">(</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsat</span> <span class="o">*</span> <span class="o">-</span> <span class="mi">2</span> <span class="p">)</span>
        <span class="n">AdductCalculator</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">formula</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">minus</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">formula</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plus</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">formula</span><span class="p">)</span>
        <span class="n">mass</span><span class="o">.</span><span class="n">MassBase</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span><span class="p">,</span>
            <span class="n">isotope</span> <span class="o">=</span> <span class="n">isotope</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">counts</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    
<div class="viewcode-block" id="FattyFragmentOld.set_name"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentOld.set_name">[docs]</a>    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;[</span><span class="si">%s</span><span class="s1">(C</span><span class="si">%u</span><span class="s1">:</span><span class="si">%u</span><span class="s1">)</span><span class="si">%s%s</span><span class="s1">]</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">name</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unsat</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">adduct_str</span><span class="p">(),</span>
            <span class="s1">&#39;&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">isotope</span> <span class="o">==</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;i</span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">isotope</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">charge_str</span><span class="p">()</span>
        <span class="p">)</span></div>
    
<div class="viewcode-block" id="FattyFragmentOld.charge_str"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentOld.charge_str">[docs]</a>    <span class="k">def</span> <span class="nf">charge_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="p">(</span><span class="s1">&#39;</span><span class="si">%u</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">))</span> <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="s1">&#39;-&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;+&#39;</span>
            <span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">!=</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;NL&#39;</span></div>
    
<div class="viewcode-block" id="FattyFragmentOld.adduct_str"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentOld.adduct_str">[docs]</a>    <span class="k">def</span> <span class="nf">adduct_str</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;</span><span class="si">%s%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span>
                <span class="p">(</span><span class="s1">&#39;-&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">minus</span>  <span class="k">else</span> \
                        <span class="s1">&#39;-</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">minus</span><span class="p">)),</span>
                <span class="p">(</span><span class="s1">&#39;+&#39;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">)</span> \
                    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">plus</span>  <span class="k">else</span> \
                        <span class="s1">&#39;+</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;+&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plus</span><span class="p">))</span>
            <span class="p">)</span></div>
    
<div class="viewcode-block" id="FattyFragmentOld.get_fragline"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentOld.get_fragline">[docs]</a>    <span class="k">def</span> <span class="nf">get_fragline</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">return</span> <span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
            <span class="s1">&#39;[M</span><span class="si">%s</span><span class="s1">]</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">adduct_str</span><span class="p">(),</span> <span class="bp">self</span><span class="o">.</span><span class="n">charge_str</span><span class="p">()),</span>
            <span class="s1">&#39;;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hg</span><span class="p">)</span>
        <span class="p">]</span></div></div>


<div class="viewcode-block" id="FattyFragmentFactory"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FattyFragmentFactory">[docs]</a><span class="k">class</span> <span class="nc">FattyFragmentFactory</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="n">docs</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;LysoPEAlkyl&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            [lyso PE(alkenyl-18:0,-)]- 464.3140997565 -417 C23H47NO6P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPE&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            [lyso PE(18:0,-)]- 480.3090143786 -476 C23H47NO7P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPCAlkyl&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            [lyso PC(alkenyl-18:0,-)]- 492.3453998849 -436 C25H51NO6P-</span>
<span class="sd">            </span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            [lyso PC(alkyl-18:0,-)]- 494.3610499491 -143 C25H53NO6P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPC&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            [lyso PC(18:0,-)]- 508.340314507 -373 C25H51NO7P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPA_mH2O&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.eu:</span>
<span class="sd">            https://massbank.eu/MassBank/jsp/RecordDisplay.jsp?id=UT002963&amp;dsn=CHUBU</span>
<span class="sd">            [lyso PS(18:0,-)-H2O]- 419.2562505266 -610 C21H40O6P-</span>
<span class="sd">            </span>
<span class="sd">            Frega 2007 Fig 15a</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPI&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank:</span>
<span class="sd">            [lyso PI(-,18:0)]- 599.3196386444 -432 C27H52O12P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPIAlkyl&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank.jp:3</span>
<span class="sd">            [lyso PI(alkyl-16:1,-)-H2O]- 537.2828592076 -228 C25H46O10P-</span>
<span class="sd">            </span>
<span class="sd">            from this, derived 18:0-:</span>
<span class="sd">            [lyso PI(alkyl-18:0,-)]- 585.3403740858 -228 C27H54O11P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPG&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank:</span>
<span class="sd">            [lyso PG(18:0,-)]- 511.3035946497 -495 C24H48O9P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPGAlkyl&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from massbank:</span>
<span class="sd">            [lyso PG(18:0,-)]- 511.3035946497 -495 C24H48O9P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPAAlkyl&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from Characterization of Phospholipid</span>
<span class="sd">            Molecular Species by Means of HPLC-Tandem Mass Spectrometry:</span>
<span class="sd">            [lyso PA(18:1,-)]- 435.2 C21H40O7P-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;LysoPA&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            from Characterization of Phospholipid</span>
<span class="sd">            Molecular Species by Means of HPLC-Tandem Mass Spectrometry:</span>
<span class="sd">            [lyso PA(18:1,-)]- 435.2 C21H40O7P-</span>
<span class="sd">            </span>
<span class="sd">            from massbank.jp:</span>
<span class="sd">            https://massbank.eu/MassBank/jsp/RecordDisplay.jsp?id=UT002963&amp;dsn=CHUBU</span>
<span class="sd">            [lyso PS(18:0,-)]- 437.2668152129 -358 C21H42O7P-</span>
<span class="sd">            </span>
<span class="sd">            Frega 2007 Fig 15a</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;FA_mO_pC2H2NH2&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            https://metlin.scripps.edu/metabo_info.php?molid=6214</span>
<span class="sd">            [Cer-FA(C8:0)]- 168.1382904 C8H14O1N1-</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;FA_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            209 at C14:0 FA, 263 at C18:1</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;FA_mO_pNH2&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            226 at C14:0 FA, 280 at C18:1</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;FA_mH&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            227 at C14:0 FA, 281 at C18:1</span>
<span class="sd">            &quot;&quot;&quot;</span><span class="p">,</span>
        <span class="s1">&#39;FAL_mH&#39;</span><span class="p">:</span>
            <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            18:1 = 267.2693393</span>
<span class="sd">            &quot;&quot;&quot;</span>
    <span class="p">}</span>
    
    <span class="c1"># class name: (head formula, minus, charge, name, headgroups, type)</span>
    <span class="c1"># TODO make this an input file instead of dict</span>
    <span class="c1"># in comments masses at 18:0</span>
    <span class="n">param_neg</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;LysoPE&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C5H9O7NH2P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPE</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPEAlkyl&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C5H11O6NH2P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPEAlkyl</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPEAlkyl_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C5H9O5NH2P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPEAlkyl</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPCAlkyl&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C7H17O6NP&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPCAlkyl</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PC&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPC&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C7H15O7NP&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPC</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PC&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPI&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C9H16O12P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPI</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPI_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C9H14O11P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPI</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPIAlkyl&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C9H18O11P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPIAlkyl</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPG&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C6H12O9P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPG</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;BMP&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPG_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C6H10O8P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPG</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;BMP&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPGAlkyl&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C6H14O8P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPGAlkyl</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPA&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C3H6O7P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPA</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPAAlkyl&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C3H8O6P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPAAlkyl</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;LysoPA_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C3H4O6P&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;LysoPA</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PS&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1"># former CerFAminusC2H5N</span>
        <span class="s1">&#39;FA_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 265.2537</span>
        <span class="c1"># former CerFAminusC</span>
        <span class="s1">&#39;FA_mO_pNH2&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-O+NH2&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1"># former CerSphiMinusN</span>
        <span class="s1">&#39;Sph_mC2H4_mNH2_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C2H5&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C2H4-NH2-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 239.2380, Hsu 2016 b5</span>
        <span class="c1"># former CerSphiMinusNO</span>
        <span class="s1">&#39;Sph_mNH2_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-NH2-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 265.2537 Hsu 2016 b4</span>
        <span class="c1"># former CerSphi</span>
        <span class="s1">&#39;Sph_mC2H4_m3H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C2H4&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C2H4-3H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 270.2436 Hsu 2016 b2, missing at DH</span>
        <span class="c1"># former CerFAminusN, FAminusH</span>
        <span class="s1">&#39;FA_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 283.2643 Hsu 2016 a6</span>
        <span class="c1"># former FAAlkylminusH</span>
        <span class="s1">&#39;FAL_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;OH&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FAL</span><span class="si">%s</span><span class="s1">-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAL&#39;</span>
            <span class="p">),</span>
        <span class="c1"># fatty acyl fragments for hydroxyacyl ceramides:</span>
        <span class="s1">&#39;FA_pC2H2_pNH2_pO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH4O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2H2+NH2+O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 342.3014 # Hsu 2016 a1 (for hydroxyacyl)</span>
        <span class="s1">&#39;FA_pC2_pNH2_pO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH2O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2+NH2+O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 340.2857 # Hsu 2016 a2 (for hydroxyacyl)</span>
        <span class="s1">&#39;FA_pC2_pNH2&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH2O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2+NH2&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 324.2908 # Hsu 2016 a3 (for hydroxyacyl), a2 (for other Cer)</span>
        <span class="s1">&#39;FA_pO_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 299.2592 # Hsu 2016 a6</span>
        <span class="s1">&#39;FA_pC2H3_pNH2_m2H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NO2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2H3+NH2-2H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 322.2752</span>
        <span class="s1">&#39;FA_pC2_pN_mO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2+N-O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 306.2802 # Hsu 2016 a5 (for hydroxyacyl)</span>
        <span class="s1">&#39;FA_pN&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+N&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 298.2752 # Hsu 2016 a6 (for hydroxyacyl)</span>
        <span class="s1">&#39;FA_m3H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-3H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 281.2486 # Hsu 2016 a8 (for hydroxyacyl)</span>
        <span class="s1">&#39;FA_mCO_m3H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;CH3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-CO-3H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span><span class="p">,</span>
                        <span class="n">oh</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;2OH&#39;</span><span class="p">,),</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FAOH&#39;</span>
            <span class="p">),</span> <span class="c1"># 253.2537 # Hsu 2016 a9 (for hydroxyacyl)</span>
        <span class="c1"># fatty acyl fragments from ceramides</span>
        <span class="s1">&#39;FA_pC2H2_pNH2&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH4O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2H2+NH2&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 326.3065 # Hsu 2016 a1</span>
        <span class="c1"># at all ceramides, former CerFA:</span>
        <span class="s1">&#39;FA_pC2_pNH2_mO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH2O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C2+NH2-O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 308.2959 Hsu 2016 a3</span>
        <span class="s1">&#39;FA_pNH2_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;ONH&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+NH2-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 282.2802</span>
        <span class="c1"># tCer specific</span>
        <span class="s1">&#39;FA_pC3H2_pNH2&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2NC3H4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+C3H2+NH2&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 338.3064 Hsu 2016 a10</span>
        <span class="c1"># sphingosine long chain base fragments from t-ceramides</span>
        <span class="s1">&#39;Sph_pO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NH2O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 316.2857</span>
        <span class="s1">&#39;Sph_mCH2_m3H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;CH2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-CH2-3H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 284.2595</span>
        <span class="s1">&#39;Sph_mNH2_m3H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-NH2-3H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 281.2486</span>
        <span class="s1">&#39;Sph_mC2H4_mNH2_m2H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C2H5&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C2H4-NH2-2H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 255.2330 # Hsu 2016 b5</span>
        <span class="s1">&#39;Sph_mCH2_mNH2_m4H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;CH5&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-CH2-NH2-4H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 267.2330 # Hsu 2016 b6</span>
        <span class="c1"># found only in beta-hydroxyacyl Cer:</span>
        <span class="s1">&#39;Sph_pC2_pOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C2NH4O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C2+OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 342.3014 # Hsu 2016 b7</span>
        <span class="c1"># sphingosine long chain base fragments from DH-ceramides</span>
        <span class="s1">&#39;Sph_mH_N&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NH2O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 300.2908 # Hsu 2016 b1</span>
        <span class="s1">&#39;Sph_mCH2_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;CH2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-CH2-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 268.2646 Hsu 2016 b3</span>
        <span class="c1"># sphingosine long chain base fragments from d-ceramides</span>
        <span class="s1">&#39;Sph_mCH2_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-CH2-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 270.2802 Hsu 2016 b2</span>
        <span class="c1"># sphingosine long chain base fragments from sphingomyelin</span>
        <span class="s1">&#39;Sph_pPCh_mCH3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;N2H12O5PC4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+PCh-CH3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 449.3150</span>
        <span class="c1"># sphingosine fragments from sphingosine</span>
        <span class="s1">&#39;Sph_mC2H3_mNH2_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C2H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C2H3-NH2-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 241.2537</span>
        <span class="c1"># fatty acyl fragments from ceramide-1-phosphate</span>
        <span class="s1">&#39;FA_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 266.2615</span>
        <span class="s1">&#39;FA&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 284.2721</span>
        <span class="c1"># sphingosine fragments from sulfohexosyl ceramide</span>
        <span class="s1">&#39;Sph_pC6O5H8_pSO3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C6O10H8S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C6O5H8+SO3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># </span>
        <span class="s1">&#39;Sph_pC6O5H8_pSO3_pH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C6O11H10S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C6O5H8+SO3+H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 542.2766</span>
        <span class="s1">&#39;Sph_pC6O5H8_pSO3_pCO_pH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C7O12H10S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C6O5H8+SO3+CO+H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 570.2715</span>
        <span class="c1"># sphingosine fragments from sulfodihexosyl ceramide</span>
        <span class="s1">&#39;Sph_pC12O10H18_pSO3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C12O15H18S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C12O10H18+SO3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 686.3189</span>
        <span class="s1">&#39;Sph_pC12O10H18_pSO3_pH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C12O16H20S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C12O10H18+SO3+H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 704.3295</span>
        <span class="s1">&#39;Sph_pC12O10H18_pSO3_pCO_pH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C13O17H20S&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+C12O10H18+SO3+CO+H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 732.3244</span>
    <span class="p">}</span>
    
    <span class="n">param_pos</span> <span class="o">=</span> <span class="p">{</span>
        <span class="c1">### neutral losses</span>
        <span class="s1">&#39;NLFA&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NL FA</span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1"># NLFAminusH2O</span>
        <span class="s1">&#39;NLFA_mH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NL FA</span><span class="si">%s</span><span class="s1">-H2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PC&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Lyso&#39;</span><span class="p">),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="s1">&#39;NLFA_m2xH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H4&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NL FA</span><span class="si">%s</span><span class="s1">-2xH2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1"># NLFAplusOH</span>
        <span class="s1">&#39;NLFA_pOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O3H&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NL FA</span><span class="si">%s</span><span class="s1">+OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1"># NLFAplusNH3</span>
        <span class="s1">&#39;NLFA_pNH3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O2NH3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;NL FA</span><span class="si">%s</span><span class="s1">+NH3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span>
        <span class="c1">### positive</span>
        <span class="c1"># FAminusO</span>
        <span class="s1">&#39;FA_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 267.2682</span>
         <span class="s1">&#39;FA_mH2O_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">-H2O-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 247.2420</span>
        <span class="c1"># FAplusGlycerol</span>
        <span class="s1">&#39;FA_pGlycerol_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;C3H5O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+Glycerol-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PA&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PI&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PG&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;BMP&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span><span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;DAG&#39;</span><span class="p">,</span> <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Lyso&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;PC&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Lyso&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 341.3050</span>
        <span class="c1"># SphingosineBase</span>
        <span class="s1">&#39;Sph_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NH4O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span> <span class="c1"># Han 2016</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;SHex2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 302.3053</span>
        <span class="c1"># sphingosine long chain base fragments from ceramide-1-phosphate</span>
        <span class="s1">&#39;Sph_m2xH2O_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-2xH2O+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;SM&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 266.2842</span>
        <span class="c1"># from tCer</span>
        <span class="s1">&#39;Sph_m2xH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-2xH2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 264.2686</span>
        <span class="c1"># fatty acyl fragments from ceramide-1-phosphate</span>
        <span class="s1">&#39;FA_pNH_pC2H2_mOH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;ONC2H2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+NH+C2H2-OH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">family</span> <span class="o">=</span> <span class="s1">&#39;SL&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 308.2948</span>
        <span class="s1">&#39;FA_pNH2_mO&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;ONH2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;FA</span><span class="si">%s</span><span class="s1">+NH2-O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;PE&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;FA&#39;</span>
            <span class="p">),</span> <span class="c1"># 284.2948</span>
        <span class="c1"># sphingosine long chain base fragments from hexosyl-t-ceramide</span>
        <span class="c1"># also from tCer</span>
        <span class="s1">&#39;Sph_mH_P&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NH2O2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 300.2897</span>
        <span class="c1"># also from tCer &amp; tSph</span>
        <span class="s1">&#39;Sph_pH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NH4O3&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">+H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 318.3003</span>
        <span class="c1"># also from tCer</span>
        <span class="s1">&#39;Sph_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;Hex&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 282.2791</span>
        <span class="s1">&#39;Sph_mH2O_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NOH2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H2O+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;1P&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 284.2948</span>
        <span class="c1"># sphingosine fragments from N-(n)methyl-safingols</span>
        <span class="s1">&#39;Sph_mH2O_pCH3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;H2NOCH2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H2O+CH3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 298.3104</span>
        <span class="c1"># from N,N-dimetthyl-sphingosine</span>
        <span class="s1">&#39;Sph_mH2O_p2xCH3_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;H2NOC2H4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-H2O+2xCH3+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 312.3261</span>
        <span class="s1">&#39;Sph_m2xH2O_p2xCH3_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NC2H4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-2xH2O+2xCH3+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 294.3155</span>
        <span class="s1">&#39;Sph_mO_mH2O_pCH3_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NCH4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-O-H2O+CH3+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 282.3155</span>
        <span class="s1">&#39;Sph_m2xH2O_pCH3&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NCH2&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-2xH2O+CH3&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M2&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sub</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;M1&#39;</span><span class="p">,),</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 280.2999</span>
        <span class="c1"># sphinosine fragments from keto-sphingosine &amp; tSph</span>
        <span class="s1">&#39;Sph_mC_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NO&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 270.2791</span>
        <span class="s1">&#39;Sph_mC_mO_mH2O_mH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C-O-H2O-H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 254.2842</span>
        <span class="s1">&#39;Sph_mC_mO_mH2O_mNH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C-O-H2O-NH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;DH&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 240.2812</span>
        <span class="s1">&#39;Sph_mC2H2_mO_mH2O_mNH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;C2H2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C2H2-O-H2O-NH&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 226.2655</span>
        <span class="s1">&#39;Sph_mNH2_mH2O_m2H&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;H3&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-NH2-H2O-2H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 265.2526</span>
        <span class="s1">&#39;Sph_mC_m2xH2O&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;CH2&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-C-2xH2O&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Cer&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;t&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 252.2686</span>
        <span class="c1"># sphingosine fragments from d-ceramide</span>
        <span class="s1">&#39;Sph_mO_pH&#39;</span><span class="p">:</span>
            <span class="n">ChainFragParam</span><span class="p">(</span>
                <span class="n">plus</span> <span class="o">=</span> <span class="s1">&#39;NOH4&#39;</span><span class="p">,</span>
                <span class="n">minus</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">charge</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Sph</span><span class="si">%s</span><span class="s1">-O+H&#39;</span><span class="p">,</span>
                <span class="n">constraints</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">FragConstraint</span><span class="p">(</span>
                        <span class="n">hg</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                        <span class="n">sph</span> <span class="o">=</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span>
                        <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span><span class="p">,</span>
                    <span class="p">),</span>
                <span class="p">),</span>
                <span class="n">chaintype</span> <span class="o">=</span> <span class="s1">&#39;Sph&#39;</span>
            <span class="p">),</span> <span class="c1"># 286.3104</span>
    <span class="p">}</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">mod</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="vm">__name__</span><span class="p">]</span>
        
        <span class="k">for</span> <span class="n">ionmode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;neg&#39;</span><span class="p">,</span> <span class="s1">&#39;pos&#39;</span><span class="p">):</span>
            
            <span class="n">param</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;param_</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">ionmode</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">par</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="n">param</span><span class="p">):</span>
                
                <span class="n">exec</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s1">&#39;def __init__(self, **kwargs):</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;    FattyFragment.__init__(</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        self,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        head = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        minus = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        name = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        charge = </span><span class="si">%u</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        ionmode = </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        attrs = {</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;            </span><span class="se">\&#39;</span><span class="s1">constraints</span><span class="se">\&#39;</span><span class="s1">: </span><span class="si">%s</span><span class="s1">,</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;            </span><span class="se">\&#39;</span><span class="s1">chaintype</span><span class="se">\&#39;</span><span class="s1">: </span><span class="se">\&#39;</span><span class="si">%s</span><span class="se">\&#39;\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        },</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;        **kwargs</span><span class="se">\n</span><span class="s1">&#39;</span>
                        <span class="s1">&#39;    )</span><span class="se">\n</span><span class="s1">&#39;</span>
                    <span class="p">)</span> <span class="o">%</span> <span class="p">(</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">plus</span><span class="p">,</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">minus</span><span class="p">,</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">charge</span><span class="p">,</span>
                        <span class="n">ionmode</span><span class="p">,</span>
                        <span class="nb">str</span><span class="p">(</span><span class="n">par</span><span class="o">.</span><span class="n">constraints</span><span class="p">),</span>
                        <span class="n">par</span><span class="o">.</span><span class="n">chaintype</span>
                    <span class="p">),</span>
                    <span class="n">mod</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">,</span>
                    <span class="n">mod</span><span class="o">.</span><span class="vm">__dict__</span>
                <span class="p">)</span>
                
                <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">docs</span><span class="p">:</span>
                    
                    <span class="n">mod</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;__init__&#39;</span><span class="p">]</span><span class="o">.</span><span class="vm">__doc__</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">docs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
                
                <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span>
                    <span class="n">name</span><span class="p">,</span>
                    <span class="p">(</span><span class="n">FattyFragment</span><span class="p">,</span> <span class="p">),</span>
                    <span class="p">{</span><span class="s1">&#39;__init__&#39;</span><span class="p">:</span> <span class="n">mod</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">[</span><span class="s1">&#39;__init__&#39;</span><span class="p">]}</span>
                <span class="p">)</span>
                
                <span class="c1"># these we set as attributes of the class</span>
                <span class="c1"># in order to be able later to inspect them</span>
                <span class="c1"># and get information about the class</span>
                <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="p">(</span>
                    <span class="p">(</span><span class="s1">&#39;chaintype&#39;</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">chaintype</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;constraints&#39;</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">constraints</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">par</span><span class="o">.</span><span class="n">name</span> <span class="o">%</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                    <span class="p">(</span><span class="s1">&#39;ionmode&#39;</span><span class="p">,</span> <span class="n">ionmode</span><span class="p">)</span>
                <span class="p">):</span>
                    
                    <span class="nb">setattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                
                <span class="nb">setattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
                
                <span class="n">fattyfragments</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        
        <span class="nb">delattr</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="s1">&#39;__init__&#39;</span><span class="p">)</span></div>


<span class="n">_factory</span> <span class="o">=</span> <span class="n">FattyFragmentFactory</span><span class="p">()</span>
<span class="k">del</span> <span class="n">_factory</span>


<div class="viewcode-block" id="FAFragSeries"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FAFragSeries">[docs]</a><span class="k">class</span> <span class="nc">FAFragSeries</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">typ</span><span class="p">,</span> <span class="n">charge</span><span class="p">,</span> <span class="n">cmin</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">unsatmin</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
        <span class="n">cmax</span> <span class="o">=</span> <span class="mi">36</span><span class="p">,</span> <span class="n">unsatmax</span> <span class="o">=</span> <span class="mi">6</span><span class="p">,</span>
        <span class="n">minus</span> <span class="o">=</span> <span class="p">[],</span> <span class="n">plus</span> <span class="o">=</span> <span class="p">[],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">iteritems</span><span class="p">(</span><span class="nb">locals</span><span class="p">()):</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsatmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsatmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsatmin</span>
        <span class="k">for</span> <span class="n">unsat</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">unsatmin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">unsatmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            
            <span class="n">this_cmin</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmin</span><span class="p">,</span> <span class="n">unsat</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">this_cmin</span> <span class="o">&lt;=</span> <span class="n">cmax</span><span class="p">:</span>
                
                <span class="k">for</span> <span class="n">cnum</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">this_cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">typ</span><span class="p">(</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cnum</span><span class="p">,</span> <span class="n">unsat</span> <span class="o">=</span> <span class="n">unsat</span><span class="p">,</span>
                            <span class="n">minus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">minus</span><span class="p">,</span> <span class="n">plus</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plus</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">fr</span>
    
<div class="viewcode-block" id="FAFragSeries.itermass"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FAFragSeries.itermass">[docs]</a>    <span class="k">def</span> <span class="nf">itermass</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">fr</span><span class="o">.</span><span class="n">mass</span></div>
    
<div class="viewcode-block" id="FAFragSeries.iterfraglines"><a class="viewcode-back" href="../../source/lipyd.html#lipyd.fragment.FAFragSeries.iterfraglines">[docs]</a>    <span class="k">def</span> <span class="nf">iterfraglines</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">fr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragments</span><span class="p">:</span>
            <span class="k">yield</span> <span class="n">fr</span><span class="o">.</span><span class="n">get_fragline</span><span class="p">()</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015-2018, Dénes Türei.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.7.19',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>